<!DOCTYPE html>
<html>
<head>

    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>Brainwaves Cyber Security Hackathon</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />
    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
	<link href='https://fonts.googleapis.com/css?family=Roboto:400,500' rel='stylesheet' type='text/css'>

  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Palanquin:400,100,200,300' '>
    <style>.hljs { background: none; }</style>
 <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript"
			src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://demo.ghost.io/assets/js/jquery.fitvids.js?v=724281a32e"></script>

    <!--[if IE]>
        <style>
            p, ol, ul{
                width: 100%;
            }
            blockquote{
                width: 100%;
            }
        </style>
    <![endif]-->
    
    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="Security Enthusiast & Developer" />
    <link rel="shortcut icon" href="/assets/images/favicon.png" type="image/png" />
    <link rel="canonical" href="/brainwaves-cyber-hack-19" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="Ravinder Nehra" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Brainwaves Cyber Security Hackathon" />
    <meta property="og:description" content="This is the fifth edition of Brainwaves hackathon. The challenges are based on filesystems i.e. how data is stored in the hard disk. We are provided with 2 dumps of a hard disk. Dump 1 The first sector of the hard disk is been modified. To load the boot loader" />
    <meta property="og:url" content="/brainwaves-cyber-hack-19" />
    <meta property="og:image" content="/assets/images/brainwaves-cover.jpg" />
    <meta property="article:publisher" content="https://www.facebook.com/rnehra01" />
    <meta property="article:author" content="https://www.facebook.com/rnehra01" />
    <meta property="article:published_time" content="2019-02-06T05:45:00+00:00" />
    <meta property="article:modified_time" content="2019-02-06T05:45:00+00:00" />
    <meta property="article:tag" content="hackathon" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Brainwaves Cyber Security Hackathon" />
    <meta name="twitter:description" content="This is the fifth edition of Brainwaves hackathon. The challenges are based on filesystems i.e. how data is stored in the hard disk. We are provided with 2 dumps of a hard disk. Dump 1 The first sector of the hard disk is been modified. To load the boot loader" />
    <meta name="twitter:url" content="/" />
    <meta name="twitter:image" content="/assets/images/brainwaves-cover.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Ravinder Nehra" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="hackathon" />
    <meta name="twitter:site" content="@rnehra01" />
    <meta name="twitter:creator" content="@rnehra01" />
    <meta property="og:image:width" content="1400" />
    <meta property="og:image:height" content="933" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "Ravinder Nehra",
        "logo": "/"
    },
    "url": "/brainwaves-cyber-hack-19",
    "image": {
        "@type": "ImageObject",
        "url": "/assets/images/brainwaves-cover.jpg",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "/brainwaves-cyber-hack-19"
    },
    "description": "This is the fifth edition of Brainwaves hackathon. The challenges are based on filesystems i.e. how data is stored in the hard disk. We are provided with 2 dumps of a hard disk. Dump 1 The first sector of the hard disk is been modified. To load the boot loader"
}
    </script>

    <!-- <script type="text/javascript" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/javascript">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="Brainwaves Cyber Security Hackathon" href="/feed.xml" />


</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="/">Ravinder Nehra</a>
            
        
        
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="/">Home</a></li>
    <li class="nav-about" role="menuitem"><a href="/about/">About</a></li>
    <li class="nav-about" role="menuitem"><a href="/assets/pdf/resume.pdf">Resume</a></li>
</ul>

        
    </div>
    <div class="site-nav-right">
	  
        <div class="social-links">
            
                <a class="social-link social-link-fb" href="https://facebook.com/rnehra01" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>
</a>
            
            
                <a class="social-link social-link-tw" href="https://twitter.com/rnehra01" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>
</a>
            
	    
                <a class="social-link social-link-gh" href="https://github.com/rnehra01" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
</a>
            
	    
                <a class="social-link social-link-linkedin" href="https://www.linkedin.com/in/rnehra01" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
</a>
            
	    
                <a class="social-link social-link-mail" href="mailto:hnehra1@gmail.com" rel="noopener"><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd"><path d="M22.288 21h-20.576c-.945 0-1.712-.767-1.712-1.712v-13.576c0-.945.767-1.712 1.712-1.712h20.576c.945 0 1.712.767 1.712 1.712v13.576c0 .945-.767 1.712-1.712 1.712zm-10.288-6.086l-9.342-6.483-.02 11.569h18.684v-11.569l-9.322 6.483zm8.869-9.914h-17.789l8.92 6.229s6.252-4.406 8.869-6.229z"/></svg>
</a>
            
	</div>
        
            <a class="subscribe-button" href="/feed.xml">Subscribe</a>
        
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full post ">

            <header class="post-full-header" >
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime=" 6 February 2019"> 6 February 2019</time>
                    
                        <span class="date-divider">/</span>
                        
                            
                               <a href='/tag/hackathon/'>hackathon</a>,
                             
                       
                            
                               <a href='/tag/security/'>security</a>
                             
                       
                    
                </section>
                <h1 class="post-full-title">Brainwaves Cyber Security Hackathon</h1>
            </header>

            
            <figure class="post-full-image" style="background-image: url(/assets/images/brainwaves-cover.jpg)">
            </figure>
            

            <section class="post-full-content">
			  
			  <div class="toc-content">			
				<ul class="section-nav">
<li class="toc-entry toc-h3"><a href="#dump-1">Dump 1</a>
<ul>
<li class="toc-entry toc-h6"><a href="#questions-based-on-dump-1">Questions based on dump 1</a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#dump-2">Dump 2</a>
<ul>
<li class="toc-entry toc-h6"><a href="#questions-based-on-dump-2">Questions based on dump 2</a></li>
</ul>
</li>
</ul>
			  </div>
			  
                <div class="kg-card-markdown post-content">
                    <p>This is the fifth edition of Brainwaves hackathon. The challenges are based on filesystems i.e. how data is stored in the hard disk. We are provided with 2 dumps of a hard disk.</p>

<h3>
<a class="anchor" href="#dump-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Dump 1</h3>
<blockquote>
<p>The first sector of the hard disk is been modified. To load the boot loader successfully at every boot process we need to fix it. Your task is to fix the first sector and upload it back to us. Corrupted bytes  of the partition entries  are replaced  with value "CC". So you need to fix  these fields only.</p>
</blockquote>
<p>According to <a href="https://en.wikipedia.org/wiki/Master_boot_record">wiki</a>, the first sector is a special boot sector called master boot record (MBR). After analyzing the given dump using <code>hexl-mode</code> in emacs, I found the corrupted <code>cc</code> bytes.</p>

<pre>
000001b0: cd10 ac3c 0075 f4c3 608d 3b68 0000 0020  ...&lt;.u..`.;h...
000001c0: 2100 debe 122c 0008 0000 <mark>cccc cccc</mark> 00be  !....,..........
000001d0: 132c 075d 0459 00f8 0a00 00f0 0a00 005d  .,.].Y.........]
000001e0: 0559 07fe ffff <mark>cccc cccc</mark> 00d0 e31d 00fe  .Y..............
000001f0: ffff 0ffe ffff 00b8 f91d 00a0 3e1c 55aa  ............&gt;..U
</pre>

<p>According to <a href="https://en.wikipedia.org/wiki/Master_boot_record#Sector_layout">MBR layout</a>, the master partition table start at address <code>1BE</code> and ends with boot signature <code>55AA</code>. The partition table consists of 4 entries and each entry looks like:
<img src="/assets/images/PartitionTables.png" alt="Partition Entry">
Based on the above information, the 4 partition entries in MBR are (the values have been converted from little-endian to big-endian):</p>

<table id="part-table">
<tbody>
<tr>
<th>Boot indicator</th>
<th>CHS(start)</th>
<th>Partition type</th>
<th>CHS(end)</th>
<th>Starting sector</th>
<th>Partition Size</th>
</tr>
<tr>
<td>00</td>
<td>002120</td>
<td>de</td>
<td>2c12be</td>
<td>00000800</td>
<td>cccccccc</td>
</tr>
<tr class="even">
<td>00</td>
<td>2c13be</td>
<td>07</td>
<td>59045d</td>
<td>000af800</td>
<td>000af000</td>
</tr>
<tr>
<td>00</td>
<td>59055d</td>
<td>07</td>
<td>fffffe</td>
<td>cccccccc</td>
<td>1de3d000</td>
</tr>
<tr class="even">
<td>00</td>
<td>fffffe</td>
<td>0f</td>
<td>fffffe</td>
<td>1df9b800</td>
<td>1c3ea000</td>
</tr>
</tbody>
</table>

<p>To fix the first 4 corrupted bytes, I need to find the size of first partition which can be calculated as difference of <code>CHS_END</code> and <code>CHS_START</code>. But first the CHS values needs to be decoded and converted in units of sectors. After reading this <a href="https://thestarman.pcministry.com/asm/mbr/PartTables.htm#Decoding">post</a>, I wrote a script that decode the 3 byte CHS hex value.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">inp</span> <span class="o">=</span> <span class="mh">0x5d0559</span>		<span class="c"># 3 byte CHS </span>

<span class="n">head</span> <span class="o">=</span> <span class="n">inp</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span>
<span class="n">sect</span> <span class="o">=</span>  <span class="p">(</span><span class="n">inp</span> <span class="o">&amp;</span> <span class="mh">0x003F00</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span>
<span class="n">cyn</span> <span class="o">=</span> <span class="p">((</span><span class="n">inp</span> <span class="o">&amp;</span> <span class="mh">0x00C000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">inp</span> <span class="o">&amp;</span> <span class="mh">0x0000FF</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'CHS : '</span><span class="p">,</span> <span class="n">cyn</span><span class="p">,</span> <span class="n">head</span><span class="p">,</span> <span class="n">sect</span><span class="p">)</span>     <span class="c"># CHS: 89, 93, 5</span></code></pre></figure>

<p>The decoded CHS values can be converted into sectors using <code>(CYLINDER*<i>heads_per_cylinder</i> + HEAD )*<i>sectors_per_head</i> + SECTORS</code> but I needed the system constants <code><i>heads_per_cylinder</i></code> and <code><i>sectors_per_head</i></code>.</p>

<p>To calculate these constants, I used the values of 2<sup>nd</sup> partition. The first equation came using partition size and second using <code>starting sector(LBA)</code> entry which is equal to <code>CHS_FIRST(in sectors)-1</code>. Solving these 2 equations, we get</p>

<pre>
<i>heads_per_cylinder</i> = 255
<i>sectors_per_head</i> = 63
</pre>

<p>Now the size of partition 1 came out 716800 (0x000af000). Similarly I calculated <code>starting sector (LBA)</code> 0x0015e800.</p>

<p>After putting these values in the dump (converted to little-endian in the dump), it looked like</p>

<pre>
000001b0: cd10 ac3c 0075 f4c3 608d 3b68 0000 0020  ...&lt;.u..`.;h... 
000001c0: 2100 debe 122c 0008 0000 <mark>00f0 0a00</mark> 00be  !....,..........
000001d0: 132c 075d 0459 00f8 0a00 00f0 0a00 005d  .,.].Y.........]
000001e0: 0559 07fe ffff <mark>00e8 1500</mark> 00d0 e31d 00fe  .Y..............
000001f0: ffff 0ffe ffff 00b8 f91d 00a0 3e1c 55aa  ............&gt;.U.
</pre>

<h6>
<a class="anchor" href="#questions-based-on-dump-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Questions based on dump 1</h6>
<blockquote>
Q1. How many primary partitions are there in the hard disk dump?
</blockquote>

<pre>
3, the 4<sup>th</sup> partition is an extended partition because its partition type is <mark>0f</mark>
and others are primary partitions.
</pre>

<blockquote>
Q2. What is the disk signature of the hard disk for the given dump?
</blockquote>

<pre>
<mark>55AA</mark>. The last 2 bytes of the first sector.
</pre>

<blockquote>
Q3. How many NTFS partitions are there?
</blockquote>

<pre>
2, partition type of NTFS is <mark>07</mark>.
</pre>

<blockquote>
Q4. What is the size of hard disk in MBs?
</blockquote>

<pre>
It can be calculated by adding size of the partitions and multiplying by
bytes_per_sector(0x200).
</pre>

<h3>
<a class="anchor" href="#dump-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>Dump 2</h3>

<blockquote>
The first sector of 2<sup>nd</sup> partition is modified to make the partition unusable by the operating system. Your task is to fix the first sector  and upload it back to us. MFT table of the partition is at the offset 0x1d3aa000 bytes from starting in the hard disk.
</blockquote>

<pre>
00000000: <mark>cc</mark>52 904e 5446 <mark>cc</mark>20 2020 2000 0208 0000  .R.NTF.    .....
00000010: 0000 0000 00f8 0000 3f00 ff00 00f8 0a00  ........?.......
00000020: 0000 0000 8000 8000 <mark>cccc cccc cccc cccc</mark>  ................
00000030: <mark>cccc cccc cccc cccc</mark> 0200 0000 0000 0000  .t..............
</pre>

<p>The first 2 corrupted bytes can be easily fixed if you look at <a href="https://en.wikipedia.org/wiki/NTFS#Partition_Boot_Sector">wiki</a>. The next 8 bytes at address 0x28 represents partition size which can looked from the partition size entry corresponding to partition2 in the  <a href="#part-table">partition table</a>.</p>

<p>The next 8 bytes represents <a href="https://en.wikipedia.org/wiki/NTFS#Master_File_Table">MFT</a> offset from start of partition. It was calculated as difference of starting byte of 2<sup>nd</sup> partition (calculated by multiplying <code>starting sector</code> and <code>bytes_per_sector</code>) and given absolute address of MFT which came out to be <code>0x74aa000</code> bytes. Now it needed to be converted in units of clusters which was done by dividing <code>bytes_per_sector</code> (0x200) and <code>sectors_per_cluster</code> (0x08). And I went to address <code>0x74aa000</code> and found the MFT was there so the calculations were correct.</p>
<pre id="dump2_fixed">
074aa000: 4649 4c45 3000 0300 2f4c 4000 0000 0000  FILE0.../L@.....
074aa010: 0100 0100 3800 0100 9801 0000 0004 0000  ....8...........
074aa020: 0000 0000 0000 0000 0700 0000 0000 0000  ................
074aa030: 0300 ffff 0000 0000 1000 0000 6000 0000  ............`...
074aa040: 0000 1800 0000 0000 4800 0000 1800 0000  ........H.......
074aa050: 78af 695d 9cd6 d001 78af 695d 9cd6 d001  x.i]....x.i]....
074aa060: 78af 695d 9cd6 d001 78af 695d 9cd6 d001  x.i]....x.i]....
074aa070: 0600 0000 0000 0000 0000 0000 0000 0000  ................
074aa080: 0000 0000 0001 0000 0000 0000 0000 0000  ................
074aa090: 0000 0000 0000 0000 3000 0000 6800 0000  ........0...h...
074aa0a0: 0000 1800 0000 0300 4a00 0000 1800 0100  ........J.......
074aa0b0: 0500 0000 0000 0500 78af 695d 9cd6 d001  ........x.i]....
074aa0c0: 78af 695d 9cd6 d001 78af 695d 9cd6 d001  x.i]....x.i]....
074aa0d0: 78af 695d 9cd6 d001 0040 0000 0000 0000  x.i].....@......
074aa0e0: 0040 0000 0000 0000 0600 0000 0000 0000  .@..............
074aa0f0: 0403 2400 5300 4f00 4300 4700 4500 4e00  ..$.S.O.C.G.E.N
074aa100: 8000 0000 4800 0000 0100 4000 0000 0600  ....H.....@.....
074aa110: 0000 0000 0000 0000 3f00 0000 0000 0000  ........?.......
</pre>

<p>This is how the dump looks after fixing it.</p>

<pre>
00000000: eb52 904e 5446 5320 2020 2000 0208 0000  .R.NTFS    .....
00000010: 0000 0000 00f8 0000 3f00 ff00 00f8 0a00  ........?.......
00000020: 0000 0000 8000 8000 00f0 0a00 0000 0000  ................
00000030: aa74 0000 0000 0000 0200 0000 0000 0000  .t..............
</pre>

<p>And on running <code>file</code> on the fixed dump, then it showed all the attributes of the partition</p>

<pre>
rnehra@pc ~&gt; file dump2_fixed
dump2_fixed: DOS/MBR boot sector, code offset 0x52+2, OEM-ID "NTFS    ", sectors/cluster 8, Media descriptor 0xf8, sectors/track 63, heads 255, hidden sectors 718848, dos &lt; 4.0 BootSector (0x80), FAT (1Y bit by descriptor); NTFS, sectors/track 63, sectors 716800, $MFT start cluster 29866, $MFTMirror start cluster 2, bytes/RecordSegment 2^(-1*246), clusters/index block 1, serial number 040ae5d9dae5d8c72
</pre>

<h6>
<a class="anchor" href="#questions-based-on-dump-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>Questions based on dump 2</h6>
<blockquote>
Q5. What is the size of cluster in bytes?
</blockquote>

<pre>
4096. Multiply <code>bytes_per_sector</code> (0x200) and <code>sectors_per_cluster</code> (0x08)
</pre>

<blockquote>
Q6. At what offset from the starting of partition the MFT table resides?
</blockquote>

<pre>
0x74aa000
</pre>

<blockquote>
Q7. What is the name of fist file?
</blockquote>

<pre>
$SOCGEN.
Visible in last lines of <a href="#dump2_fixed">first sector</a> of the partition
</pre>

<blockquote>
Q8. Which is the first non-system or non-Meta file in MFT entry?
</blockquote>

<pre>
MYDATA.TXT
Look at the location of non-Meta file <a href="https://en.wikipedia.org/wiki/NTFS#Metafiles">here</a>.
</pre>

<p>This is a good but easy online hackathon which requires knowledge of boot sector, filesystems and bootloaders basics. So I recommend the organisers that they can increase the difficulty a bit but I give them full marks for choosing a topic that teaches more about the system which I use everyday.</p>

                </div>
		
            </section>

            <!-- Email subscribe form at the bottom of the page -->
            <!--  -->
            <!--     <section class="subscribe-form"> -->
            <!--         <h3 class="subscribe-form-title">Subscribe to Ravinder Nehra</h3> -->
            <!--         <p>Get the latest posts delivered right to your inbox</p> -->
            <!--         <form method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  /><input class="location" type="hidden" name="location"  /><input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email"  placeholder="youremail@example.com" />
    </div>
    <button class="" type="submit" disabled><span>Subscribe</span></button>
    <script type="text/javascript">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>
</form>
 -->
            <!--     </section> -->
            <!--  -->

            <footer class="post-full-footer">
                <!-- Everything inside the #author tags pulls data from the author -->
                <!-- #author-->
                
                    
                        <section class="author-card">
                            
                                <img class="author-profile-image" src="/assets/images/my.jpg" alt="rnehra01" />
                            
                            <section class="author-card-content">
                                <h4 class="author-card-name"><a href="/about/">Ravinder Nehra</a></h4>
                                
                                    <p>Security Enthusiast & Developer</p>                              
                                
                            </section>
                        </section>
                        <div class="post-full-footer-right">
                            <a class="author-card-button" href="/about/">Read More</a>
                        </div>
                    
                
                <!-- /author  -->
            </footer>

            <!-- If you use Disqus comments, just uncomment this block.
            The only thing you need to change is "test-apkdzgmqhj" - which
            should be replaced with your own Disqus site-id. -->
            
                <section class="post-full-comments">
                    <div id="disqus_thread"></div>
                    <script>
                        var disqus_config = function () {
                            this.page.url = '/';
                            this.page.identifier = 'Ravinder Nehra';
                        };
                        (function() {
                            var d = document, s = d.createElement('script');
                            s.src = 'https://rnehra01-github-io.disqus.com/embed.js';
                            s.setAttribute('data-timestamp', +new Date());
                            (d.head || d.body).appendChild(s);
                        })();
                    </script>
                </section>
            

        </article>

    </div>
</main>

<!-- Links to Previous/Next posts -->
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            
                
                
                
                
            

            <!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs -->
            
                
    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/Dumping-tables-using-sqlmap">
                <div class="post-card-image" style="background-image: url(/assets/images/sqlmap.png)"></div>
            </a>
        
        <div class="post-card-content">
            <div class="post-card-content-link">
              <header class="post-card-header">
		<time class="post-card-tags-date" datetime="27 March 2019">27 March 2019</time>
                
		<span class="post-card-tags-date">/</span>
                        
                            
                               <a class="post-card-tags-date" href='/tag/sqli/'>sqli,</a>
                            
                        
                            
                               <a class="post-card-tags-date" href='/tag/sqlmap/'>sqlmap,</a>
                            
                        
                            
                               <a class="post-card-tags-date" href='/tag/web/'>web,</a>
                            
                        
                            
                               <a class="post-card-tags-date" href='/tag/security/'>security,</a>
                            
                        
                            
                                <a class="post-card-tags-date" href='/tag/ctf/'>ctf</a>
                            
                        
                    
			  </header>
			  <a class="post-card-header-excerpt-link" href="/Dumping-tables-using-sqlmap">
	      <header class="post-card-header">
                    <h2 class="post-card-title">Dumping tables using sqlmap;--</h2>
          </header>
                <section class="post-card-excerpt">
                    
                        <p>This post will try to show a small portion of power that sqlmap possess. sequel This is a web challenge from BSides SF CTF 2019. The home page shows a login form. After...</p>
                    
                </section>
			  </a>
            </div>
            <footer class="post-card-meta">
			<span class="reading-time">
                        
                        
                          3 min read
                        
            </span>
            </footer>
        </div>
    </article>

            

            <!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs -->
            
                    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/path-to-gsoc17">
                <div class="post-card-image" style="background-image: url(/assets/images/gsoc-honeynet-17.png)"></div>
            </a>
        
        <div class="post-card-content">
            <div class="post-card-content-link">
              <header class="post-card-header">
		<time class="post-card-tags-date" datetime="14 June 2017">14 June 2017</time>
                
		<span class="post-card-tags-date">/</span>
                        
                            
                               <a class="post-card-tags-date" href='/tag/gsoc/'>gsoc,</a>
                            
                        
                            
                               <a class="post-card-tags-date" href='/tag/dev/'>dev,</a>
                            
                        
                            
                                <a class="post-card-tags-date" href='/tag/security/'>security</a>
                            
                        
                    
			  </header>
			  <a class="post-card-header-excerpt-link" href="/path-to-gsoc17">
	      <header class="post-card-header">
                    <h2 class="post-card-title">$PATH to GSoC'17</h2>
          </header>
                <section class="post-card-excerpt">
                    
                        <p>It started almost a year back when I heard about GSoC for the first time in an introductory lecture by SDSLabs. I was quite a noob except knowing a little about competitive coding....</p>
                    
                </section>
			  </a>
            </div>
            <footer class="post-card-meta">
			<span class="reading-time">
                        
                        
                          3 min read
                        
            </span>
            </footer>
        </div>
    </article>

            

        </div>
    </div>
</aside>

<!-- Floating header which appears on-scroll, included from includes/floating-header.hbs -->
<div class="floating-header">
    <div class="floating-header-logo">
        <a href="/">
            
            <span>Ravinder Nehra</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">Brainwaves Cyber Security Hackathon</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=Brainwaves+Cyber+Security+Hackathon&amp;url=https://rnehra01.github.io/brainwaves-cyber-hack-19"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>

        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://rnehra01.github.io/brainwaves-cyber-hack-19"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>

        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->


        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="/">Ravinder Nehra</a> &copy; 2019</section>
                <!-- <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> & -->
                <!--     <a href="https://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a> using -->
                <!--     <a href="https://github.com/jekyller/jasper2" target="_blank" rel="noopener">Jasper2</a></section> -->
                <nav class="site-footer-nav">
                    <a href="/">Latest Posts</a>
                    <a href="https://facebook.com/rnehra01" target="_blank" rel="noopener">Facebook</a>
                    <a href="https://twitter.com/rnehra01" target="_blank" rel="noopener">Twitter</a>
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    
        <div id="subscribe" class="subscribe-overlay">
            <a class="subscribe-overlay-close" href="#"></a>
            <div class="subscribe-overlay-content">
                
                <h1 class="subscribe-overlay-title">Subscribe to Ravinder Nehra</h1>
                <p class="subscribe-overlay-description">Stay up to date! Get all the latest &amp; greatest posts delivered straight to your inbox</p>
                <form method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  /><input class="location" type="hidden" name="location"  /><input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email"  placeholder="youremail@example.com" />
    </div>
    <button class="" type="submit" disabled><span>Subscribe</span></button>
    <script type="text/javascript">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>
</form>

            </div>
        </div>
    

    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.10.0/components/prism-abap.min.js"></script>
    <script>$(document).ready(function() {
      $('pre code').each(function(i, block) {
        hljs.highlightBlock(block);
      });
    });</script>

    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-102153288-1', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->

</body>
</html>
